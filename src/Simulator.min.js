var Simulator=function(t){console.log("Simulator.new");try{this.DT=1/t,this.time=0,this.ships=[],this.shots=[],this.impacts=[],this.decos=[];var i=new GunPattern(.05,.02);i.projectile.audio=null,this.collisionDetector=new CollisionDetector(this),this.player=new Player,this.register("ship",this.player)}catch(s){console.log("ERROR(Arena.new): "+s)}};Simulator.prototype.register=function(t,i){i.creationTime=this.time,"ship"===t?this.ships.push(i):"shot"===t?this.shots.push(i):"impact"===t?this.impacts.push(i):"deco"===t&&this.decos.push(i)},Simulator.prototype.update=function(){try{for(;this.decos.length<1e3;){var t=new Vec(Math.random()-.5,Math.random()-.5);t.scale(1e4),t.x+=this.player.position.x,t.y+=this.player.position.y;var i=new Star(t);this.register("deco",i)}for(var s in this.decos){var i=this.decos[s];i.update(this.DT),i.isDestroyed()&&this.decos.splice(this.decos.indexOf(i),1)}for(var s in this.ships){var e=this.ships[s];if(e.update(this.DT),e.isDestroyed()){this.ships.splice(this.ships.indexOf(e),1);for(var o=0;250>o;o++){var h=new Sim(EXPLOSION_DISPLAY,e.position,25),r=Math.random()*FULL_CIRCLE;h.speed=new Vec(Math.cos(r),Math.sin(r)),h.speed.normalize(2e3*Math.random()),h.retroEngine=.05,h.lifeTime=.1+1*Math.random(),this.register("deco",h)}}}for(var s in this.shots){var a=this.shots[s];a.update(this.DT),a.isDestroyed()&&this.shots.splice(this.shots.indexOf(a),1)}this.collisionDetector.update();for(var s in this.impacts){var i=this.impacts[s];i.update(this.DT),i.isDestroyed()&&this.impacts.splice(this.impacts.indexOf(i),1)}this.time+=this.DT}catch(n){console.log("ERROR(Simulator.update): "+n)}};